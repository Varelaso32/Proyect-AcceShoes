<app-navbar></app-navbar>

<!-- BotÃ³n flotante volver -->
<button (click)="goBack()" class="fixed top-24 left-4 z-50 btn btn-m btn-accent shadow-md">
  â¬… AtrÃ¡s
</button>

<div class="container mx-auto px-4 pt-32 min-h-screen pb-20">
  <h2 class="text-3xl font-bold text-cyan-700 mb-10 text-center">Todos los productos</h2>

  <ng-container *ngIf="groupedProducts$ | async as grouped">
    <div *ngFor="let category of grouped | keyvalue" class="mb-16">
      <div class="relative flex items-center my-8">
        <hr class="flex-grow border-t border-cyan-300">
        <span class="mx-4 text-2xl font-semibold text-cyan-600 whitespace-nowrap">
          {{ category.key }}
        </span>
        <hr class="flex-grow border-t border-cyan-300">
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
        <div *ngFor="let product of category.value" class="card bg-base-100 shadow-xl hover:shadow-2xl transition">
          <figure class="px-4 pt-4">
            <img [src]="product.imageUrl" [alt]="product.name" class="rounded-xl h-48 w-full object-cover"
              (error)="product.imageUrl = '/api/placeholder/300/300'" />
          </figure>
          <div class="card-body">
            <h3 class="card-title text-cyan-700">{{ product.name }}</h3>
            <p class="text-gray-500">{{ product.description }}</p>
            <div class="mt-2">
              <span class="badge badge-outline">{{ product.category }}</span>
            </div>
            <div class="mt-4 flex justify-between items-center gap-2">
              <span class="text-xl font-bold text-cyan-600">${{ product.price.toFixed(2) }}</span>

              <div class="flex gap-2">
                <button (click)="addToCart(product)" class="btn btn-sm bg-green-500 text-white hover:bg-green-600">
                  ðŸ›’ Agregar al carrito
                </button>

                <button class="btn btn-sm bg-cyan-600 text-white hover:bg-cyan-700"
                  [routerLink]="['/product', product.id]">
                  Ver detalles
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </ng-container>
</div>

<app-footer></app-footer>